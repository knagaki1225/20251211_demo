<!DOCTYPE html>

<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>内容確認</title>
    <link rel="stylesheet" href="../css/books/Book-review.css">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

</head>

<body>
    <header class="signup-header">
        <a href="review-form.html" class="back-link">&lt;&nbsp;&nbsp;もどる</a>
        <div class="step-indicator">
            <div class="step">
                <div class="step-number">1</div>
                <div class="step-label">書籍の登録</div>
            </div>
            <div class="step-line-box">
                <div class="step-line"></div>
            </div>
            <div class="step">
                <div class="step-number">2</div>
                <div class="step-label">書評の入力</div>
            </div>
            <div class="step-line-box">
                <div class="step-line"></div>
            </div>
            <div class="step active">
                <div class="step-number">3</div>
                <div class="step-label">内容の確認</div>
            </div>
        </div>
    </header>

    <main>
        <div class="form-container">
            <p class="intro-text">登録内容に誤りがないか、よくご確認ください</p>
            <div class="info-box">
                <div class="details-list">
                    <h2 class="book-title" id="result-title">（タイトル）</h2>
                    <div class="book-info-wrapper">
                        <img src="" alt="書影" class="book-cover" id="result-cover">
                        <div class="book-details">
                            <div class="detail-item">
                                <label>著者</label>
                                <p id="result-author">（著者）</p>
                            </div>
                            <div class="detail-item">
                                <label>出版社</label>
                                <p id="result-publisher">（出版社）</p>
                            </div>
                        </div>
                    </div>
                    <div class="detail-top">
                        <div class="detail-item">
                            <label class="label-border">書評タイトル</label>
                            <div class="value-display" id="result-review-title">
                            </div>
                        </div>
                        <div class="detail-item">
                            <label class="label-border">書評内容</label>
                            <div class="value-display-bio" id="result-review-content">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="btn-review-box">
                <div class="btn-shadow">
                    <a href="review-form.html" class="btn-review btn-register  btn-color-left">書評入力へ戻る</a>
                </div>
                <div class="btn-shadow">
                    <button id="submit-btn" class="btn-review btn-register btn-color-right">投稿する</button>
                </div>
            </div>
            <footer>@copylite</footer>
        </div>
    </main>


    <script>
        document.addEventListener('DOMContentLoaded', function () {

            // localStorage から reviewData を取得
            const reviewDataJson = localStorage.getItem('reviewData');
            const bookCover = localStorage.getItem('book_cover');

            if (reviewDataJson) {
                const reviewData = JSON.parse(reviewDataJson);

                // 書籍情報表示
                document.getElementById('result-cover').src = bookCover || "https://via.placeholder.com/100x150?text=No+Image";
                document.getElementById('result-title').textContent = reviewData.bookTitle || '情報なし';
                document.getElementById('result-author').textContent = reviewData.bookAuthor || '情報なし';
                document.getElementById('result-publisher').textContent = reviewData.bookPublisher || '情報なし';

                // 書評情報表示
                document.getElementById('result-review-title').textContent = reviewData.reviewTitle || '入力なし';
                document.getElementById('result-review-content').innerHTML = reviewData.reviewContent ?
                    reviewData.reviewContent.replace(/\n/g, '<br>') : '入力なし';

                console.log('取得したデータ:', reviewData);
            } else {
                // データがない場合のエラー処理
                document.querySelector('.intro-text').textContent = '表示するデータがありません。書籍登録からやり直してください。';
                document.querySelector('.details-list').innerHTML = '<p style="text-align: center; color: red;">データ取得エラー</p>';
            }

            // 投稿ボタンのクリックイベント
            document.getElementById('submit-btn').addEventListener('click', async function () {

                window.location.href = 'book-complete.html';

            });

            // Cookieから値を取得する関数
            function getCookie(name) {
                const value = `; ${document.cookie}`;
                const parts = value.split(`; ${name}=`);
                if (parts.length === 2) return parts.pop().split(';').shift();
                return null;
            }
        });
    </script>
</body>

</html>